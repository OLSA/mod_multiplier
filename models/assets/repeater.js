/* Repeater v1.2 http://olsa.me */
!function(e){function t(){var t=e('select[id^="jform_params_wrapper_"], input[id^="jform_params_wrapper_"], textarea[id^="jform_params_wrapper_"]');h=t.length,e.each(t,function(e,t){f.push({id:t.id,type:t.localName,name:t.id.replace("jform_params_wrapper_",""),value:""})})}function n(t,n){var r=s(),a=r[t];r.splice(t,1),r.splice(n,0,a),g.val("");for(var o=0;o<r.length;++o)c(r[o]);e("#outer-list").empty(),y=0,i(r)}function r(){var t=e("button.add");w?(t.text("Update Item"),t.addClass("btn-success")):(t.text("Add Item"),t.removeClass("btn-success"))}function a(t){for(var n=0;h>n;++n){var r=e("#"+t+" span."+f[n].name);e("#"+f[n].id).val(r.text()),e("#"+f[n].id).trigger("liszt:updated")}}function o(){for(var t={},n=0;h>n;++n)t[f[n].name]=e("#"+f[n].id).val();return t}function s(){var e={},t=g.val();return""!==t&&(e=JSON.parse("["+t+"]")),e}function i(e){for(var t=e.length,n=0;t>n;++n)l(e[n])}function l(t){for(var n="",r=0;h>r;++r)n+='<span class="name">'+f[r].name+'</span> <span class="value '+f[r].name+'">'+t[f[r].name]+"</span> ";n+=' <a href="#edit-row" class="edit">edit</a>',n+=' <a href="#remove-row" class="remove">&#215;</a>',e("#outer-list").append(e('<li id="row_'+y++ +'">').append(n))}function c(e){var t=[];""!==g.val()&&t.push(g.val()),t.push(JSON.stringify(e)),t.join(),g.val(t)}function p(t){var n=s();n[y]=t,g.val("");for(var r=0;r<n.length;++r)c(n[r]);e("#outer-list").empty(),y=0,i(n)}function u(){return window.scrollTo({behavior:"smooth",top:100}),!1}function d(e){Element.prototype.documentOffsetTop=function(){return this.offsetTop+(this.offsetParent?this.offsetParent.documentOffsetTop():0)};var t=e.documentOffsetTop()-window.innerHeight/2;return window.scrollTo({behavior:"smooth",top:t}),!1}function m(t){var n=document.getElementById("system-message-container");n.innerHTML=['<div id="overlay"><div id="popup">','<button class="close" onclick="Joomla.removeMessages()"><span>Ã—</span></button>',t,'<button class="btn btn-default" onclick="Joomla.removeMessages()">Close</button>',"</div></div>"].join("");var r=e(document).height(),a=e(window).width();e("#overlay").css({width:a,height:r});var o=e(window).height(),s=e(window).width();e("#popup").css("top",o/2-e("#popup").height()/2),e("#popup").css("left",s/2-e("#popup").width()/2)}function v(){var e=1,t=new Date;t.setTime(t.getTime()+24*e*60*60*1e3);var n=t.toUTCString(),r=arguments.length,a="string"==typeof arguments[r-1];if(a&&r++,3>r)throw new TypeError("executeOnce - not enough arguments");var o=arguments[0],s=arguments[r-2];if("function"!=typeof o)throw new TypeError("executeOnce - first argument must be a function");if(!s||/^(?:expires|max\-age|path|domain|secure)$/i.test(s))throw new TypeError("executeOnce - invalid identifier");return"1"===decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(s).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))?!1:(o.apply(r>3?arguments[1]:null,r>4?Array.prototype.slice.call(arguments,2,r-2):[]),document.cookie=encodeURIComponent(s)+"=1; expires="+n+(a||!arguments[r-1]?"; path=/":""),!0)}var f=[],h=0,g="",w=!1;e(document).ready(function(){g=e("#jform_params_content"),t(),""!==g.val()&&i(s()),e("#outer-list").sortable({axis:"y",cursor:"move",start:function(t,n){e("#outer-list li").removeAttr("class"),w=!1,r(),e(this).attr("data-previndex",n.item.index())},update:function(t,r){var a=r.item.index(),o=e(this).attr("data-previndex");e(this).removeAttr("data-previndex"),n(o,a)}}),e(".add").on("click",function(e){e.preventDefault();var t=o();w?(d(document.getElementsByClassName("selected")[0]),p(t),w=!1,r(),$msg=["<h3>Updated successfully!</h3>",'<p>To save all changes, at the end, press "Save" button.</p>','<p class="small">This message will be executed only once a day.</p>'].join(""),v(m,null,$msg,"multiplier")):(c(t),l(t))}),e("#outer-list").on("click",".remove",function(t){t.preventDefault(),w=!1,r();var n=parseInt(e(this).parents("li").attr("id").replace("row_",""),10),a=s();a.splice(n,1),g.val("");for(var o=0;o<a.length;++o)c(a[o]);e("#outer-list").empty(),y=0,i(a)}),e("#outer-list").on("click",".edit",function(t){t.preventDefault(),y=parseInt(e(this).parents("li").attr("id").replace("row_",""),10),row_selected=e(this).parents("li").attr("id"),"selected"!=document.getElementById(row_selected).className?(e("#outer-list li").removeAttr("class"),document.getElementById(row_selected).className+="selected",w=!0,a(row_selected),r(),u(t)):(e("#outer-list li").removeAttr("class"),w=!1,r())})});var y=0}(jQuery);